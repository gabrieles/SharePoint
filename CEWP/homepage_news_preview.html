<div class="wrapper homepage-wrapper first-row">
	<div class="container dis-t pl-0">
		<div class="row dis-tr">
			<div class="col-md-8 col-xs-12 bg-stretch-before bg-yellow dis-tc pl-0">
				<div class="container-md">
					<div class="row">
						<div class="half-width-col">
							<div id="firstNews">
							</div>
							<!-- end top-news -->
						</div>
						<div class="half-width-col">
							<div class="icr-container-wrapper newsItem_wrapper">
								<div id="secondNews">
								</div>
							</div>
							<!-- end news-block -->
							<div class="icr-container-wrapper newsItem_wrapper">
								<div id="thirdNews">
								</div>
							</div>
							<!-- end news-block -->
							<div class="icr-container-wrapper newsItem_wrapper bg-white">
								<div id="fourthNews">
								</div>
							</div>
							<!-- end news-focus -->
							<div class="icr-container-wrapper newsItem_wrapper bg-white">
								<div id="fifthNews">
								</div>
							</div>
							<!-- end news-focus -->
							<div class="btn-top-padding hidden-sm hidden-md hidden-lg">
								<a class="icr-btn btn-red" href="/News">View all news
									
									
									<span class="glyphicon glyphicon-chevron-right">
									</span>
								</a>
							</div>
						</div>
					</div>
				</div>
				<!-- end news-wrapper -->
			</div>
			<div class="col-md-4 col-xs-12 dis-tc va-top" id="conversationsSection">
				<div class="sm-pad">
					<div class="fl bg-l-grey" style="width:100%">
						<h2 class="header-container homepage-header pb-10">Conversations
						</h2>
						<div class="block-content">
							<div id="conversations">
								<div class="container-md"><div class="sm-thumb cover-bg img-border" style="background-image:url('/_layouts/userphoto.aspx?size=S&amp;accountName=Heather.Lacey@icr.ac.uk')"></div><div class="text-table"><p><a class="line-clamp-2" href="https://nexus.icr.ac.uk/teams/board/Lists/Discussion Board/Run the Royal Parks Half Marathon this October!">This is just a preview </span></span></a></p><div class="icr-meta"><span>17 Jul</span><span class="icr-meta-space"></span><span>0 Replies</span><span class="icr-meta-space"></span><span><a href="https://my.nexus.icr.ac.uk/Person.aspx?accountname=icr\hlacey">Heather Lacey</a></span></div></div></div><div class="container-md"><div class="sm-thumb cover-bg img-border" style="background-image:url('/_layouts/userphoto.aspx?size=S&amp;accountName=Helen.Craig@icr.ac.uk')"></div><div class="text-table"><p><a class="line-clamp-2" href="https://nexus.icr.ac.uk/teams/Public Engagement/Lists/Discussion Board/Careers leaflet now availiable digitally">The conversations in here are all fake</a></p><div class="icr-meta"><span>14 Jul</span><span class="icr-meta-space"></span><span>0 Replies</span><span class="icr-meta-space"></span><span><a href="https://my.nexus.icr.ac.uk/Person.aspx?accountname=icr\hcraig">Helen Craig</a></span></div></div></div><div class="container-md"><div class="sm-thumb cover-bg img-border" style="background-image:url('/_layouts/userphoto.aspx?size=S&amp;accountName=Helen.Craig@icr.ac.uk')"></div><div class="text-table"><p><a class="line-clamp-2" href="https://nexus.icr.ac.uk/teams/board/Lists/Discussion Board/Have you engaged with the public this year">But the layout is the same as in the homepage</a></p><div class="icr-meta"><span>13 Jul</span><span class="icr-meta-space"></span><span>0 Replies</span><span class="icr-meta-space"></span><span><a href="https://my.nexus.icr.ac.uk/Person.aspx?accountname=icr\hcraig">Helen Craig</a></span></div></div></div><div class="container-md"><div class="sm-thumb cover-bg img-border" style="background-image:url('/_layouts/userphoto.aspx?size=S&amp;accountName=Richard.Hoey@icr.ac.uk')"></div><div class="text-table"><p><a class="line-clamp-2" href="https://nexus.icr.ac.uk/teams/board/Lists/Discussion Board/Members wanted for Science Communication Forum">So please ignore this section</a></p><div class="icr-meta"><span>11 Jul</span><span class="icr-meta-space"></span><span>0 Replies</span><span class="icr-meta-space"></span><span><a href="https://my.nexus.icr.ac.uk/Person.aspx?accountname=icr\rhoey">Richard Hoey</a></span></div></div></div><div class="container-md"><div class="sm-thumb cover-bg img-border" style="background-image:url('/_layouts/userphoto.aspx?size=S&amp;accountName=Igor.Kozin@icr.ac.uk')"></div><div class="text-table"><p><a class="line-clamp-2" href="https://nexus.icr.ac.uk/teams/Deep Learning/Lists/Discussion Board/competition Predict the effect of Genetic Variants to enable Personalized Medicine">And just forcus on setting the news</a></p><div class="icr-meta"><span>11 Jul</span><span class="icr-meta-space"></span><span>0 Replies</span><span class="icr-meta-space"></span><span><a href="https://my.nexus.icr.ac.uk/Person.aspx?accountname=icr\ikozin">Igor Kozin</a></span></div></div></div>
							</div>
						</div>
						<!-- end conversation block -->
						<div class="btn-padding">
							<a class="icr-btn btn-red" href="/Search/Pages/conversationresults.aspx">
								View all conversations
								
								<span class="glyphicon glyphicon-chevron-right">
								</span>
							</a>
						</div>
					</div>
				</div>
				<!-- end conversation-wrapper -->
			</div>
		</div>
	</div>
</div>

<div class="wrapper homepage-wrapper second-row bg-l-grey bg-stretch-before bg-stretch-after">
	<div class="container pl-0">
		<div class="row">
			<table class="ms-formtable" style="margin-top: 8px;" border="0" cellpadding="0" cellspacing="0" width="100%">
				<tbody>
					<tr><td class="form-section-wrapper" colspan="2"><div class="form-section-header bc-5">Select news</div><div class="form-section-subtitle"></div></td></tr>
					<tr>
						<td nowrap="true" valign="top" class="ms-formlabel">
							<h3 class="ms-standardheader">Top story</h3>
						</td>
						<td valign="top" class="ms-formbody">
							<select id="topStorySelect"></select>
						</td>
					</tr>
					<tr>
						<td nowrap="true" valign="top" class="ms-formlabel">
							<h3 class="ms-standardheader">News1</h3>
						</td>
						<td valign="top" class="ms-formbody">
							<select id="News1Select"></select>
						</td>
					</tr>
					<tr>
						<td nowrap="true" valign="top" class="ms-formlabel">
							<h3 class="ms-standardheader">News2</h3>
						</td>
						<td valign="top" class="ms-formbody">
							<select id="News2Select"></select>
						</td>
					</tr>
					<tr>
						<td nowrap="true" valign="top" class="ms-formlabel">
							<h3 class="ms-standardheader" id="Feature1header">Feature1</h3>
						</td>
						<td valign="top" class="ms-formbody">
							<select id="Feature1Select"></select>
						</td>
					</tr>
					<tr>
						<td nowrap="true" valign="top" class="ms-formlabel">
							<h3 class="ms-standardheader" id="Feature2header">Feature2</h3>
						</td>
						<td valign="top" class="ms-formbody">
							<select id="Feature2Select"></select>
						</td>
					</tr>
				</tbody>
			</table>
			
			<button onclick="updatePreview()" type="button" style="margin-top: 20px;">Update</button>

			<div class="pb-40 mb-20" style="border-bottom: 2px solid #A71930;"></div>
		</div>
	</div>
</div>	


<!-- end info-wrapper -->

<style>
h3.ms-standardheader {
    width: 200px;
}

#WebPartWPQ1 > table {
	width: 100%;
}
.second-row td.form-section-wrapper {
    padding-top: 10px;
}
</style>
</style>

<script>

function updatePreview(){

//This is a page to allow news managers to simply define what news should go in the homepage.
//by default is should use the current logic: pick the latest top story, the latest 2 news items, and the latest features
//users should see a dropdown with the 20 latest top stores, 20 latest news, and 20 latest features, so that they can easily choose to use different items (limit to 20 since we do not want a far too big dropdown list)
//once an item in the dropdown has been chosen, update the preview.
//for additional customisation, users can manually fill the form below (thus, they may point at items that are not in the "standard" list of news). As they make changes to the form, update the preview.
//Once all this has been done, remove the "Update" button as it wil no longer be needed
//on save the system will store the value in the form, which is a list of text fields with all the information that is necessary to generate the homepage.

//Important for the approval process: develop similar code to be used in the displayForm.aspx so that when users visits an item they can see the how the homepage would look like. 
//Once this is ready, change the homepage code to fetch the latest item in this list and use its values to create the HTML for the news block.



	var html = '';
		
	var link = '';
	var imgURL = '';
	var title = '';
	var date = '';
	
	//top story
	link = 	 $("input[title='Top story title Required Field']").val();
	imgURL = $("input[title='Top story image URL Required Field']").val();
	//if the image url does not contain the RenditionID, add it
	if (!imgURL.endsWith("?RenditionID=5")) { imgURL += '?RenditionID=5'; }
	title = $("input[title='Top story title Required Field']").val();
	date = $("input[title='Top story date Required Field']").val();
	html= 	'<div id="firstNews">' +
				'<a href="' + link + '" class="main-news-thumb main-news-img cover-bg" style="background-image:url(\' ' + imgURL + '\')"></a>'+
				'<div class="icr-top-news-block">'+
					'<h2 class="top-news-text link-dg"><a class="line-clamp-3" href="' + link + '"><span class="ellip">' + title + '</span></a></h2>'+
					'<div class="icr-meta"><span>' + date + '</span></div>'+
				'</div>'+
				'<div class="btn-top-padding hidden-xs"><a class="icr-btn btn-red" href="/news">View all news<span class="glyphicon glyphicon-chevron-right"></span></a></div>'+
			'</div>';
	$('#firstNews').html(html);
	
	//do the same for all the other news and features...
	
}

    $(document).ready(function ($) {
		//query the system to fetch the list of news and features to populate the dropdowns (display their title, but store in data attributes their URL and date so that you do not need to make additional queries)
		//on change of the dropdowns, update the values in the form, then trigger the updatePreview function
		//on change of the values in the form (if a user manually edits the values), and trigger the updatePreview function
		

	});		
</script><html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"><head>
<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:Notes0 msdt:dt="string"></mso:Notes0>
</mso:CustomDocumentProperties>
</xml><![endif]-->
<title></title></head>